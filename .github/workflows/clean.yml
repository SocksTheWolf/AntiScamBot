name: "Clean Actions"

on:
  schedule:
    - cron: "0 0 * * 1"
  workflow_dispatch:

jobs:
  clean-actions:
    runs-on: ubuntu-latest
    permissions:
      actions: write
    steps:
      - name: Clean GH Actions
        id: clean
        uses: igorjs/gh-actions-clean-workflow@v7
        with:
          runs_older_than: 10
          runs_to_keep: 5

      - name: Display metrics
        run: |
          echo "Total runs found: ${{ steps.clean.outputs.total-runs-found }}"
          echo "Runs deleted: ${{ steps.clean.outputs.runs-deleted }}"
          echo "Runs failed: ${{ steps.clean.outputs.runs-failed }}"
          echo "API requests: ${{ steps.clean.outputs.total-api-requests }}"
          echo "Rate limit hits: ${{ steps.clean.outputs.rate-limit-hits }}"
